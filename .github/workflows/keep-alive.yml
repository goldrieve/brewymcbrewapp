name: Keep Streamlit App Alive

on:
  schedule:
    # Run every 10 minutes
    - cron: '*/10 * * * *'
  workflow_dispatch: # Allow manual trigger

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Streamlit App
        run: |
          # Replace with your actual Streamlit app URL
          APP_URL="https://brewymcbrewapp.streamlit.app"
          
          if [ -z "$APP_URL" ]; then
            exit 1
          fi
          
          echo "üîÑ Pinging Streamlit app at: $APP_URL"
          
          # Make request to keep app alive
          HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" -L --max-time 30 "$APP_URL")
          
          if [ $HTTP_CODE -eq 200 ] || [ $HTTP_CODE -eq 301 ] || [ $HTTP_CODE -eq 302 ]; then
            echo "‚úÖ App is alive! (HTTP $HTTP_CODE)"
          else
            echo "‚ö†Ô∏è  Unexpected response code: HTTP $HTTP_CODE"
            echo "App might be down or URL is incorrect"
          fi
          
      - name: Keep workflow active
        run: |
          echo "Workflow ran at: $(date -u '+%Y-%m-%d %H:%M:%S UTC')"
          echo "Next run in ~10 minutes"
